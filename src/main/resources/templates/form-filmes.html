<!DOCTYPE html>
<html lang="pt-BR" xmlns:th="http://www.thymeleaf.org">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title th:text="${filme.id != null ? 'CineAn√°lise - Editar Filme' : 'CineAn√°lise - Cadastrar Filme'}">CineAn√°lise</title>

        <script src="https://cdn.tailwindcss.com"></script>

        <link rel="stylesheet" th:href="@{/css/styles.css}">
    </head>
    <body class="antialiased">

        <div class="container mx-auto p-4 md:p-8 max-w-4xl">

            <header class="mb-8 text-center">
                <h1 class="text-5xl">CineAn√°lise 95</h1>
                <button id="theme-toggle" class="mt-4">
                    Dark Mode
                </button>
            </header>

            <div th:if="${mensagem}" class="mb-4">
                <div th:class="${'alert fade-in ' + (tipo == 'sucesso' ? 'alert-success' : 'alert-error')}">
                    <p th:text="${mensagem}"></p>
                </div>
            </div>

            <main class="window">
                <div class="title-bar" th:text="${filme.id != null ? 'Editar Filme' : 'Cadastrar Novo Filme'}"></div>

                <form th:action="${filme.id != null ? '/filmes/editar/' + filme.id : '/filmes'}" 
                      th:object="${filme}" 
                      method="post" 
                      class="p-2"
                      id="filme-form">

                    <input type="hidden" th:field="*{id}" th:if="${filme.id != null}">

                    <div class="form-group">
                        <label for="titulo" class="label required">T√≠tulo</label>
                        <input type="text" 
                               id="titulo" 
                               th:field="*{titulo}" 
                               required 
                               class="input"
                               placeholder="Ex: Matrix"
                               maxlength="200"
                               autofocus>
                    </div>

                    <div class="form-group">
                        <label for="sinopse" class="label required">Sinopse</label>
                        <textarea id="sinopse" 
                                  th:field="*{sinopse}" 
                                  rows="5" 
                                  required 
                                  class="textarea"
                                  placeholder="Descreva a hist√≥ria do filme..."
                                  maxlength="2000"></textarea>
                        <p class="text-sm mt-1 text-muted">M√°ximo 2000 caracteres</p>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <!-- Campo G√™nero -->
                        <div class="form-group">
                            <label for="genero" class="label required">G√™nero</label>
                            <input type="text" 
                                   id="genero" 
                                   th:field="*{genero}" 
                                   required 
                                   class="input"
                                   placeholder="Ex: Fic√ß√£o Cient√≠fica"
                                   maxlength="100">
                            <p class="text-sm mt-1 text-muted">Exemplos: Drama, A√ß√£o, Suspense, Com√©dia</p>
                        </div>

                        <div class="form-group">
                            <label for="ano" class="label required">Ano</label>
                            <input type="number" 
                                   id="ano" 
                                   th:field="*{ano}" 
                                   required 
                                   class="input"
                                   placeholder="Ex: 1999"
                                   min="1900"
                                   max="2100">
                            <p class="text-sm mt-1 text-muted">Ano de lan√ßamento do filme</p>
                        </div>
                    </div>

                    <div class="separator"></div>

                    <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-4">
                        <p class="text-sm text-muted">
                            <span class="required"></span> Campos obrigat√≥rios
                        </p>

                        <div class="flex gap-2 w-full md:w-auto">
                            <a th:href="@{/filmes}" class="button flex-1 md:flex-none text-center">
                                ‚ùå Cancelar
                            </a>
                            <button type="submit" class="button button-success flex-1 md:flex-none">
                                üíæ <span th:text="${filme.id != null ? 'Atualizar' : 'Salvar'}"></span>
                            </button>
                        </div>
                    </div>
                </form>

                <div th:if="${filme.id != null}" class="mt-4 p-2 alert alert-info">
                    <p class="text-sm">
                        ‚ÑπÔ∏è <strong>Aten√ß√£o:</strong> Voc√™ est√° editando o filme "<span th:text="${filme.titulo}"></span>". 
                        As an√°lises existentes n√£o ser√£o afetadas.
                    </p>
                </div>

                <div class="mt-4 p-2 window">
                    <div class="title-bar">üí° Dicas de Preenchimento</div>
                    <div class="p-2">
                        <ul class="space-y-2" style="list-style-type: none; padding-left: 0;">
                            <li><strong>T√≠tulo:</strong> Use o t√≠tulo original ou traduzido do filme</li>
                            <li><strong>Sinopse:</strong> Descreva a hist√≥ria sem revelar spoilers importantes</li>
                            <li><strong>G√™nero:</strong> Pode usar m√∫ltiplos g√™neros separados por "/" (Ex: A√ß√£o/Aventura)</li>
                            <li><strong>Ano:</strong> Ano de lan√ßamento nos cinemas, n√£o o ano de produ√ß√£o</li>
                        </ul>
                    </div>
                </div>
            </main>

            <div class="mt-4 text-center text-sm text-muted">
                <p>Todos os dados s√£o obrigat√≥rios para garantir informa√ß√µes completas sobre o filme.</p>
            </div>
        </div>

        <script th:src="@{/js/DarkMode.js}"></script>
        <script th:src="@{/js/form-validation.js}"></script>
    </body>
</html>