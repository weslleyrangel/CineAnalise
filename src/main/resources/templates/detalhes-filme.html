<!DOCTYPE html>
<html lang="pt-BR" xmlns:th="http://www.thymeleaf.org">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title th:text="${'CineAnÃ¡lise - ' + filme.titulo}">CineAnÃ¡lise</title>

        <script src="https://cdn.tailwindcss.com"></script>

        <link rel="stylesheet" th:href="@{/css/styles.css}">
    </head>
    <body class="antialiased">

        <div class="container mx-auto p-4 md:p-8 max-w-4xl">

            <header class="mb-8 text-center">
                <h1 class="text-5xl">CineAnÃ¡lise 95</h1>
                <button id="theme-toggle" class="mt-4">
                    Dark Mode
                </button>
            </header>

            <main class="window">

                <div id="detalhes-filme-container">
                    <div class="title-bar" th:text="${filme.titulo}"></div>
                    <div class="p-2">
                        <div class="mb-4" th:text="${filme.genero + ' - ' + filme.ano}"></div>
                        <p th:text="${filme.sinopse}"></p>
                    </div>
                </div>

                <div class="mt-8">
                    <div class="title-bar">AnÃ¡lises</div>
                    <div class="space-y-4 p-2">

                        <div th:if="${#lists.isEmpty(analises)}">
                            <p>Nenhuma anÃ¡lise ainda.</p>
                        </div>

                        <div th:each="analise : ${analises}" class="window !p-2 analise-card">
                            <p class="estrelas" th:text="${'â˜…'.repeat(analise.nota) + 'â˜†'.repeat(5 - analise.nota)}"></p>
                            <p class="mt-2" th:text="${analise.texto}"></p>
                        </div>
                    </div>
                </div>

                <div class="mt-8">
                    <div class="title-bar">Adicionar sua AnÃ¡lise</div>
                    <form th:action="@{/filmes/{id}/analises(id=${filme.id})}" 
                          th:object="${novaAnalise}" 
                          method="post" 
                          class="p-2 space-y-4">

                        <div class="form-group">
                            <label for="nota" class="label">Nota</label>
                            <select id="nota" th:field="*{nota}" required class="select">
                                <option value="5">5 Estrelas â˜…â˜…â˜…â˜…â˜…</option>
                                <option value="4">4 Estrelas â˜…â˜…â˜…â˜…â˜†</option>
                                <option value="3">3 Estrelas â˜…â˜…â˜…â˜†â˜†</option>
                                <option value="2">2 Estrelas â˜…â˜…â˜†â˜†â˜†</option>
                                <option value="1">1 Estrela â˜…â˜†â˜†â˜†â˜†</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="analise-texto" class="label">Sua anÃ¡lise</label>
                            <textarea id="analise-texto" 
                                      th:field="*{texto}" 
                                      rows="4" 
                                      required 
                                      class="textarea"
                                      maxlength="2000"
                                      placeholder="Escreva sua opiniÃ£o sobre o filme..."></textarea>
                        </div>

                        <div class="flex justify-end">
                            <button type="submit" class="button button-success">ðŸ’¾ Salvar AnÃ¡lise</button>
                        </div>
                    </form>
                </div>

                <div class="mt-8 text-center">
                    <a th:href="@{/filmes}" class="button">&lt;- Voltar para a Lista</a>
                </div>
            </main>
        </div>

        <script th:src="@{/js/DarkMode.js}"></script>
        <script th:src="@{/js/form-validation.js}"></script>
    </body>
</html>